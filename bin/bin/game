#!/usr/bin/env sh
xrandr --auto
game_start(){
    systemctl --user stop picom # Disable compositor
    nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=Off, AllowGSYNCCompatible=On}"
}

game_stop(){
    nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=Off, AllowGSYNCCompatible=Off}"
    systemctl --user start picom # Re-enable your compositor
}

case "$1" in
    start) game_start "$@" ;;
    end) game_stop "$@" ;;
    toggle)
        if pgrep picom > /dev/null; then
            game_start "$@"
        else
            game_stop "$@"
        fi ;;
    *) true ;;
esac
