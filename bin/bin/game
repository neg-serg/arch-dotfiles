#!/usr/bin/env sh
second_screen=false
xrandr --auto
case "$1" in
    start) 
        systemctl --user stop picom # Disable compositor
        if [ $second_screen = true ]; then
            nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=Off, AllowGSYNCCompatible=On}, HDMI-0: nvidia-auto-select +0+0 {ForceCompositionPipeline=Off}"
            xrandr --output HDMI-1 --off #Disable 2ยบ screen
        else
            nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=Off, AllowGSYNCCompatible=On}"
        fi
    ;;
    end) 
        if [ $second_screen = true ]; then
            xrandr --output HDMI-0 --auto # Re-enable 2ยบ screen
            nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=On, AllowGSYNCCompatible=Off}, HDMI-0: nvidia-auto-select +0+0 {ForceCompositionPipeline=On}"
        else
            nvidia-settings --assign CurrentMetaMode="DP-2: 3440x1440_175 +0+0 {ForceCompositionPipeline=On, AllowGSYNCCompatible=Off}"
        fi
        systemctl --user start picom # Re-enable your compositor
    ;;
    *) true ;;
esac
