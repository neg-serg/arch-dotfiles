[general]
accounts = Gmail
maxsyncaccounts = 3
pythonfile = ~/bin/scripts/utf7.py

[Account Gmail]
localrepository = Gmail-Local
remoterepository = Gmail-Remote
quick = 30
postsynchook = notmuch new
autorefresh = 3

[Repository Gmail-Local]
type = Maildir
auth_mechanisms = XOAUTH2
localfolders = ~/.local/mail/gmail
nametrans: lambda s: {  '[Gmail]/Starred'   : '[Gmail].Starred',
                        '[Gmail]/Trash'     : '[Gmail].Trash',
                        'gmail/Trash'       : '[Gmail].Trash',
                        '[Gmail]/Sent Mail' : '[Gmail].Sent Mail',
                        '[Gmail]/Important' : '[Gmail].Important',
                        '[Gmail]/Drafts'    : '[Gmail].Drafts',
                        '[Gmail]/All Mail'  : '[Gmail].All Mail',
                        'INBOX'             : 'INBOX'
                      }.get (s, s).decode ('imap4-utf-7').encode ('utf8')

[Repository Gmail-Remote]
type = Gmail
remoteuser = serg.zorg@gmail.com
remotepasseval = get_pass()
realdelete = no
maxconnections = 3
keepalive = 60
holdconnectionopen = yes

nametrans = lambda foldername: foldername.decode('imap4-utf-7').encode('utf-8')

folderfilter = lambda folder: folder not in ['[Gmail].Trash',
                                             '[Gmail].Important',
                                             '[Gmail].Spam',
                                             '[Gmail].All Mail',
                                             'Trash'
                                             ]
ssl = yes
# Necessary as of OfflineIMAP 6.5.4
sslcacertfile = /etc/ssl/certs/ca-certificates.crt
# Necessary to work around https://github.com/OfflineIMAP/offlineimap/issues/573 (versions 7.0.12, 7.2.1)
ssl_version = tls1_2

[mbnames]
enabled = yes
sep = " "
filename = ~/.mutt/mailboxes
header = "mailboxes "
peritem = "~/.local/mail/gmail/%(foldername)s"
footer = "\n"
